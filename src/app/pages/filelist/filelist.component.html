<md-card *ngIf="! project">
  <md-card-content>
    <p>Selectionnez un projet dans la liste...<p>
  </md-card-content>
</md-card>

<datatable *ngIf="project"
    [options] = "{addButton: true, addButtonTooltip: 'Ajouter un fichier', emptyMessage: 'Ce projet ne contient pas encore de fichier.'}"
    [dataObs]="files"
    [columns]="['Fichier', 'Auteur', 'Version', 'Date d\'upload', 'Statut', '']"
    (addButtonClick)="add()">
  <datatable-title>
    <h2>Projet : {{project.name}}</h2>
  </datatable-title>
  <ng-template let-file="item">
    <td>
      <span mdTooltip="{{file.version?.filename}}" mdTooltipPosition="above" mdTooltipHideDelay="0">{{file.version?.filename | truncate:30}}</span>
    </td>
    <td>{{file.author?.firstname}} {{file.author?.name}}</td>
    <td>{{file.version?.num}}</td>
    <td>{{file.version?.date_upload?.day | numberLen:2}}/{{file.version?.date_upload?.month | numberLen:2}}/{{file.version?.date_upload?.year | numberLen:4}}</td>
    <td>{{file.version?.status}}</td>
    <td>
      <span *ngIf="file.version && file.version.status == 0"><a md-raised-button color="primary" mdTooltip="Télécharger" mdTooltipPosition="above" target="_self" [href]="downloadLink(file.version.id)" download><md-icon>file_download</md-icon></a></span>
      <span *ngIf="file.author && file.author.id == userId"><a md-raised-button color="accent" mdTooltip="Nouvelle version" mdTooltipPosition="above" [routerLink]="['/add_file', project.id, file.id]" download><md-icon>file_upload</md-icon></a></span>
    </td>
  </ng-template>
</datatable>
